<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width">
  <script type="text/javascript" charset="UTF-8" src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js">
  </script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />

  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  <style>
    body {
      font-family: sans-serif;
    }
  </style>

  <title>Limits of functions</title>
</head>

<body>

  <h1 class="firstHeading">
    Limits of functions at \(x_0\)</h1>
  <center>
    <div id="box" class="jxgbox" style="width:500px; height:500px; "></div>
  </center>

  <br clear="all">
  <script language="JavaScript">
    "use strict";

    var n, button1, button2, v2, v3, p1, p2, p3u, p3o, eps, p4u, p4o, pol, val, l1, l2, l3, TO, b1, a, b, f, graph, v2, v3,
      g1, one, zero, p1, textx0;
    b1 = JXG.JSXGraph.initBoard('box', { boundingbox: [-3, 2, 4.5, -4], grid: true, axis: true });
    b1.snapToGrid = true;

    var f = function (x) {
      if (x < 0) {
        return -Math.pow(x + 2, 2) / 2 + 1;
      }
      if (x <= 0.00001) { return -2; }
      if (x < 1) { return -3 * Math.pow(x - 1, 2) / 2 + 0.5; }
      if (x == 1) { return 1; }

      return 1 / (x - 1 / 3);
    }

    graph = b1.create('functiongraph', [f, -2, 4], { strokeColor: JXG.palette.skyblue });
    zero = b1.create('point', [0, -2], {
      fillColor: '#0000ff',
      strokeColor: '#0000ff',
      strokeWidth: 2,
      fixed: true,
      name: ' '
    });

    one = b1.create('point', [1, 1], {
      fillColor: '#0000ff',
      strokeColor: '#0000ff',
      strokeWidth: 2,
      fixed: true,
      name: ' '
    });


    /*
    g1 = b1.create('glider', [1, 0, b1.defaultAxes.x],
        { name: 'x_0', snapSizeX: 0.05, snapToGrid: true });
*/
    g1 = b1.create('slider', [[-1, 0], [3, 0], [-1, 1, 3]],
      {
        name: 'x0',
        snapSizeX: 0.05,
        snapToGrid: true,
        size: 3,
        label: { name: 'nix', visible: true },
        withLabel: false,
        strokeColor: JXG.palette.red,
        fillColor: JXG.palette.red,
        highlightStrokeColor: JXG.palette.darkred,
        highlightFillColor: JXG.palette.darkred,
        highlightStrokeWidth: 9,
        highline: { strokeWidth: 0, highlightstrokewidth: 0 },
        baseline: { strokeWidth: 0, highlightstrokewidth: 0.1, highlightStrokeColor: '#000000' },
      });
    textx0 = b1.create('text', [0, -0.2, "x_0"], { anchor: g1 });
    p1 = b1.create('point', [function () { return g1.X(); }, function () { return f(g1.X()); }],
      { name: 'f(x_0)' });

    g1.on("drag", function (e) {
      clear_all();
    });

    var inputan = b1.create('input', [-2.5, -2.5, 'x0.Value()-1/n', 'x_n='], { cssStyle: 'width: 100px', frozen: true });
    var button1 = b1.create('button', [1, -2.5, 'start', function () { clear_all(); start_approx(); }], { frozen: true });
    var button2 = b1.create('button', [2, -2.5, 'stop', function () { stop_approx(); }], { frozen: true });
    var button2 = b1.create('button', [3, -2.5, 'clear', function () {
      clear_all();
    }], { frozen: true });
    var inputstart = b1.create('input', [1, -2.5, '1', 'start at n='], { cssStyle: 'width: 50px', frozen: true, visible: false });
    var buttonex1 = b1.create('button', [-2.5, -3, 'x_0-1/n', function () { updateInputAn('x0.Value()-1/n'); }], { frozen: true });
    var buttonex2 = b1.create('button', [-1, -3, 'x_0-(-1)^n/n', function () { updateInputAn('x0.Value()-(-1)^n/n'); }], { frozen: true });
    var buttonex3 = b1.create('button', [1, -3, 'x_0+(-1)^n/2', function () { updateInputAn('x0.Value()+(-1)^n/2'); }], { frozen: true });
    var buttonex4 = b1.create('button', [3, -3, 'x_0-0.9^n', function () { updateInputAn('x0.Value()-0.9^n'); }], { frozen: true });
    function updateInputAn(newstring) {
      inputan.set(newstring)

    }

    var seq_add = function () {
      var val = a_n(n);
      v2.setPosition(JXG.COORDS_BY_USER, [val, 0]);
      v3.setPosition(JXG.COORDS_BY_USER, [val, f(val)]);
      n++;
    };

    var approx = function () {
      seq_add();
      b1.update();
      if (n <= 50) {
        TO = setTimeout(approx, 500);
      }
      else {
        g1.setAttribute({ fixed: false })
      }
    };

    var a_n;
    var start_approx = function () {
      v2 = b1.create('point', [0, 0],
        {
          size: 2, strokeColor: JXG.palette.orange, fillColor: JXG.palette.orange, name: "x_n", trace: false, visible: false,
          label: { anchorX: 'right' }, layer: 10, fixed: true
        });
      v3 = b1.create('point', [0, 0],
        {
          size: 1, fillColor: JXG.palette.green, strokeColor: JXG.palette.green,
          name: "", trace: false, visible: false, layer: 10
        });
      a_n = b1.jc.snippet(inputan.Value(), true, 'n', true);
      n = b1.jc.snippet(inputstart.Value(), false, ' ', false);
      val = a_n(n);
      v2.setPosition(JXG.COORDS_BY_USER, [val, 0]);
      v2.setAttribute({ visible: true, trace: true });
      v3.setPosition(JXG.COORDS_BY_USER, [val, f(val)]);
      v3.setAttribute({ visible: true, trace: true });
      g1.setAttribute({ fixed: true })
      approx();

    }

    var clear_all = function () {
      clearTimeout(TO);
      g1.setAttribute({ fixed: false })
      b1.removeObject([v2, v3]);
    };
    var stop_approx = function () {
      clearTimeout(TO);
      g1.setAttribute({ fixed: false })

    };

  </script>


</body>

</html>